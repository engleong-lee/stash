# Stash - Implementation Tasks

> **Project:** Stash - Tab Session Manager (Browser Extension)  
> **Started:** December 25, 2024  
> **Target Completion:** 2-3 weeks  
> **Status:** In Progress

---

## Progress Overview

| Phase | Tasks | Completed | Progress |
|-------|-------|-----------|----------|
| Phase 0: Setup | 6 | 6 | ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ© 100% |
| Phase 1: Core MVP | 28 | 28 | ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ© 100% |
| Phase 2: Polish & Features | 22 | 22 | ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ© 100% |
| Phase 3: AI & Distribution | 21 | 20 | ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ© 95% |
| **Total** | **77** | **76** | **99%** |

---

## Phase 0: Project Setup
**Goal:** Development environment ready, extension scaffolded  
**Estimated Time:** 2-3 hours

### Environment Setup

- [x] **0.1** Verify Node.js installation
  - [x] Check: `node --version` (should be 18+) âœ… v20.19.5
  - [x] Check: `npm --version` âœ… 10.8.2

- [x] **0.2** Create project with Vite
  - [x] Run: `npm create vite@latest . -- --template react-ts --overwrite` âœ…
  - [x] Project created in current directory âœ…

- [x] **0.3** Install dependencies
  - [x] Run: `npm install` âœ…
  - [x] Run: `npm install zustand` âœ…
  - [x] Run: `npm install -D tailwindcss@3 postcss autoprefixer` âœ…
  - [x] Run: `npm install -D @crxjs/vite-plugin` âœ…
  - [x] Run: `npx tailwindcss init -p` âœ…

- [x] **0.4** Configure Tailwind CSS
  - [x] Update `tailwind.config.js` with content paths âœ…
  - [x] Add Tailwind directives to `src/index.css` âœ…

- [x] **0.5** Create manifest.json
  - [x] Create `public/manifest.json` âœ…
  - [x] Set manifest_version to 3 âœ…
  - [x] Add name, version, description âœ…
  - [x] Add permissions: tabs, storage âœ…
  - [x] Configure action (popup) âœ…
  - [x] Configure icons âœ…

- [x] **0.6** Configure Vite for extension
  - [x] Update `vite.config.ts` with CRXJS plugin âœ…
  - [x] Verify build works: `npm run build` âœ…
  - [x] Extension ready to load in Chrome âœ…

---

## Phase 1: Core MVP
**Goal:** Save and restore sessions with clean UI  
**Estimated Time:** 1 week

### 1A. Project Structure

- [x] **1.1** Create folder structure
  - [x] Create `src/popup/` for popup UI âœ…
  - [x] Create `src/popup/components/` âœ…
  - [x] Create `src/popup/hooks/` âœ…
  - [x] Create `src/popup/stores/` âœ…
  - [x] Create `src/background/` for service worker âœ…
  - [x] Create `src/lib/` for shared utilities âœ…

- [x] **1.2** Create TypeScript types (`src/lib/types.ts`)
  - [x] Define `Session` interface âœ…
  - [x] Define `Tab` interface âœ…
  - [x] Define `Settings` interface âœ…
  - [x] Define `StorageData` interface âœ…

- [x] **1.3** Create constants (`src/lib/constants.ts`)
  - [x] Define storage keys âœ…
  - [x] Define default settings âœ…

### 1B. Storage Layer

- [x] **1.4** Create storage utilities (`src/lib/storage.ts`)
  - [x] Implement `getSessions()` âœ…
  - [x] Implement `saveSession(session)` âœ…
  - [x] Implement `deleteSession(id)` âœ…
  - [x] Implement `updateSession(id, updates)` âœ…
  - [x] Implement `getSettings()` âœ…
  - [x] Implement `saveSettings(settings)` âœ…

- [x] **1.5** Create session store (`src/popup/stores/sessionStore.ts`)
  - [x] Add state: `sessions`, `isLoading` âœ…
  - [x] Add action: `loadSessions()` âœ…
  - [x] Add action: `addSession(session)` âœ…
  - [x] Add action: `removeSession(id)` âœ…
  - [x] Add action: `updateSession(id, updates)` âœ…

### 1C. Background Service Worker

- [x] **1.6** Create background entry (`src/background/index.ts`)
  - [x] Set up service worker âœ…
  - [x] Register message listeners âœ…

- [x] **1.7** Create tabs utility (`src/background/tabs.ts`)
  - [x] Implement `getCurrentTabs()` - get all tabs in current window âœ…
  - [x] Implement `restoreTabs(tabs, newWindow)` - open tabs âœ…

- [x] **1.8** Create storage handler (`src/background/storage.ts`)
  - [x] Handle storage operations from popup âœ…
  - [x] Implement message passing âœ…

### 1D. Popup UI - Basic Components

- [x] **1.9** Create App component (`src/popup/components/App.tsx`)
  - [x] Set up main layout âœ…
  - [x] Load sessions on mount âœ…
  - [x] Handle loading state âœ…

- [x] **1.10** Create popup entry (`src/popup/popup.tsx`)
  - [x] Mount React app âœ…
  - [x] Import global styles âœ…

- [x] **1.11** Create popup HTML (`src/popup/popup.html`)
  - [x] Basic HTML structure âœ…
  - [x] Link to popup.tsx âœ…

- [x] **1.12** Update manifest for popup
  - [x] Point action.default_popup to popup.html âœ…

### 1E. Save Session Flow

- [x] **1.13** Create StashButton component (`src/popup/components/StashButton.tsx`)
  - [x] Display "Stash All Tabs (X)" button âœ…
  - [x] Show current tab count âœ…
  - [x] Handle click to open save dialog âœ…

- [x] **1.14** Create SaveDialog component (`src/popup/components/SaveDialog.tsx`)
  - [x] Input field for session name âœ…
  - [x] Pre-fill with default name (date-based) âœ…
  - [x] Save button âœ…
  - [x] Cancel button âœ…
  - [x] "Close tabs after saving" checkbox âœ…

- [x] **1.15** Create useCurrentTabs hook (`src/popup/hooks/useCurrentTabs.ts`)
  - [x] Fetch current window tabs on mount âœ…
  - [x] Return tabs array and count âœ…

- [x] **1.16** Implement save flow
  - [x] Get current tabs via chrome.tabs API âœ…
  - [x] Create session object with UUID âœ…
  - [x] Save to chrome.storage.local âœ…
  - [x] Update session list âœ…
  - [x] Optional: close tabs after save âœ…

- [x] **1.17** Create Toast component (`src/popup/components/Toast.tsx`)
  - [x] Show success/error messages âœ…
  - [x] Auto-dismiss after 2 seconds âœ…
  - [x] Position at bottom of popup âœ…

### 1F. Session List & Restore

- [x] **1.18** Create SessionList component (`src/popup/components/SessionList.tsx`)
  - [x] Render list of sessions âœ…
  - [x] Handle empty state âœ…
  - [x] Sort by date (newest first) âœ…

- [x] **1.19** Create SessionItem component (`src/popup/components/SessionItem.tsx`)
  - [x] Display session name âœ…
  - [x] Display tab count âœ…
  - [x] Display relative date ("2 hours ago") âœ…
  - [x] Handle click to restore âœ…

- [x] **1.20** Implement restore flow
  - [x] Get session by ID âœ…
  - [x] Open all tabs via chrome.tabs.create âœ…
  - [x] Option: open in new window âœ…
  - [x] Show success toast âœ…

- [x] **1.21** Create relative time utility
  - [x] Implement `formatRelativeTime(timestamp)` âœ…
  - [x] "Just now", "5 minutes ago", "2 hours ago", "Yesterday", etc. âœ…

### 1G. Search

- [x] **1.22** Create SearchBar component (`src/popup/components/SearchBar.tsx`)
  - [x] Search input with icon âœ…
  - [x] Placeholder text âœ…
  - [x] Clear button when has value âœ…

- [x] **1.23** Create useSearch hook (`src/popup/hooks/useSearch.ts`)
  - [x] Filter sessions by query âœ…
  - [x] Search session names âœ…
  - [x] Search tab titles and URLs within sessions âœ…
  - [x] Debounce input (100ms) âœ…

- [x] **1.24** Wire up search to SessionList
  - [x] Pass filtered sessions to list âœ…
  - [x] Show "no results" state âœ…

### 1H. Basic Styling

- [x] **1.25** Set popup dimensions
  - [x] Width: 360px âœ…
  - [x] Max height: 480px âœ…
  - [x] Configure in CSS âœ…

- [x] **1.26** Style SearchBar
  - [x] Rounded input âœ…
  - [x] Search icon âœ…
  - [x] Focus state âœ…

- [x] **1.27** Style StashButton
  - [x] Primary color (indigo) âœ…
  - [x] Full width âœ…
  - [x] Hover state âœ…

- [x] **1.28** Style SessionList and SessionItem
  - [x] Clean list layout âœ…
  - [x] Hover state âœ…
  - [x] Subtle borders âœ…

---

## Phase 2: Polish & Features
**Goal:** Refined UX, management features, keyboard shortcuts  
**Estimated Time:** 1 week

### 2A. Session Management

- [x] **2.1** Add delete functionality
  - [x] Add trash icon on hover âœ…
  - [x] Confirmation dialog âœ…
  - [x] Delete from storage âœ…
  - [x] Update list âœ…

- [x] **2.2** Add rename functionality
  - [x] Add edit icon on hover âœ…
  - [x] Inline editing mode âœ…
  - [x] Save on Enter, cancel on Escape âœ…
  - [x] Update storage âœ…

- [x] **2.3** Add undo delete
  - [x] Store deleted session temporarily âœ…
  - [x] Show "Undo" in toast âœ…
  - [x] Restore if clicked within 5 seconds âœ…

- [x] **2.4** Add session preview on hover
  - [x] Show first 3-4 tabs âœ…
  - [x] Display favicon and title âœ…
  - [x] "+X more tabs" indicator âœ…

### 2B. Tab Selection Mode

- [x] **2.5** Create TabSelector component (`src/popup/components/TabSelector.tsx`)
  - [x] List current tabs with checkboxes âœ…
  - [x] Show favicon and title per tab âœ…
  - [x] Select all / Deselect all buttons âœ…

- [x] **2.6** Add toggle for selection mode
  - [x] Button to switch from "Stash All" to "Select Tabs" âœ…
  - [x] Cancel button to return âœ…

- [x] **2.7** Implement selective save
  - [x] Only save checked tabs âœ…
  - [x] Update tab count display âœ…
  - [x] Proceed to save dialog âœ…

### 2C. Settings

- [x] **2.8** Create Settings component (`src/popup/components/Settings.tsx`)
  - [x] Back button to main view âœ…
  - [x] Settings form âœ…

- [x] **2.9** Add restore behavior setting
  - [x] Radio: Open in new window / current window âœ…
  - [x] Save to storage âœ…

- [x] **2.10** Add close tabs setting
  - [x] Checkbox: Close tabs after saving (default) âœ…
  - [x] Save to storage âœ…

- [x] **2.11** Add settings icon to header
  - [x] Gear icon âœ…
  - [x] Navigate to settings view âœ…

- [x] **2.12** Create UI store (`src/popup/stores/uiStore.ts`)
  - [x] State: current view (main / settings / select) âœ…
  - [x] Actions: navigate between views âœ…

### 2D. Keyboard Shortcuts

- [x] **2.13** Configure commands in manifest
  - [x] _execute_action: Cmd+Shift+S âœ…
  - [x] quick-stash: Cmd+Shift+A âœ…

- [x] **2.14** Implement quick stash command
  - [x] Listen in background service worker âœ…
  - [x] Save all tabs with default name âœ…
  - [x] Show notification (placeholder) âœ…

- [x] **2.15** Add keyboard navigation in popup
  - [x] Arrow keys to navigate session list (basic) âœ…
  - [x] Enter to restore selected âœ…
  - [x] Delete to remove selected (basic) âœ…
  - [x] `/` to focus search âœ…

- [x] **2.16** Add keyboard hints in UI
  - [x] Basic shortcuts implemented âœ…

### 2E. Visual Polish

- [x] **2.17** Add dark mode support
  - [x] Detect system preference âœ…
  - [x] Dark color palette âœ…
  - [x] Toggle in settings (optional) âœ…

- [x] **2.18** Add loading states
  - [x] Skeleton for session list âœ…
  - [x] Spinner for save/restore operations âœ…

- [x] **2.19** Add animations
  - [x] Fade in popup âœ…
  - [x] Slide in new sessions âœ…
  - [x] Fade out deleted sessions âœ…

- [x] **2.20** Polish empty states
  - [x] No sessions: friendly illustration + message âœ…
  - [x] No search results: helpful message âœ…

- [x] **2.21** Add icons
  - [x] Session icon (folder) âœ…
  - [x] Tab count icon âœ…
  - [x] Action icons (delete, edit, settings) âœ…

- [x] **2.22** Final styling pass
  - [x] Consistent spacing âœ…
  - [x] Typography hierarchy âœ…
  - [x] Color consistency âœ…

---

## Phase 3: AI & Distribution
**Goal:** AI naming with Ollama + Claude, store submission  
**Estimated Time:** 1 week

### 3A. AI Integration - Core

- [x] **3.1** Create AI provider interface (`src/background/ai/index.ts`)
  - [x] Define `AIProvider` interface âœ…
  - [x] Define `generateSessionName(tabTitles: string[]): Promise<string>` âœ…
  - [x] Implement provider selection logic âœ…
  - [x] Implement fallback chain âœ…

- [x] **3.2** Create prompt template
  - [x] Input: list of tab titles âœ…
  - [x] Output: short 2-4 word name âœ…
  - [x] Same prompt works for both providers âœ…

### 3B. Ollama Provider

- [x] **3.3** Create Ollama provider (`src/background/ai/ollama.ts`)
  - [x] Implement `isOllamaAvailable()` - check localhost:11434 âœ…
  - [x] Implement `getAvailableModels()` - list installed models âœ…
  - [x] Implement `generateName(tabTitles, model)` - call /api/generate âœ…
  - [x] Handle timeout (5s max) âœ…
  - [x] Handle connection errors gracefully âœ…

- [x] **3.4** Test Ollama API calls
  - [x] Verify localhost:11434 is accessible from extension âœ…
  - [x] Test with llama3.2:1b model âœ…
  - [x] Test with other models âœ…

### 3C. Claude API Provider

- [x] **3.5** Create Claude provider (`src/background/ai/claude.ts`)
  - [x] Set up Claude API call (Haiku model) âœ…
  - [x] Handle API key from settings âœ…
  - [x] Handle API errors âœ…
  - [x] Handle rate limits âœ…

### 3D. AI Settings UI

- [x] **3.6** Update Settings component for AI options
  - [x] Toggle: Enable AI naming âœ…
  - [x] Radio group: Ollama / Claude API âœ…
  - [x] Dropdown: Ollama model selection (populated from API) âœ…
  - [x] Input: Claude API key (shown only if Claude selected) âœ…
  - [x] Status indicator: "âœ… Ollama running" or "âŒ Ollama not detected" âœ…

- [x] **3.7** Create useOllamaStatus hook
  - [x] Check if Ollama is running on mount âœ…
  - [x] Fetch available models âœ…
  - [x] Refresh on settings open âœ…

- [x] **3.8** Add host_permissions to manifest
  - [x] Add `http://localhost:11434/*` to manifest.json âœ…
  - [x] Add `https://api.anthropic.com/*` to manifest.json âœ…

### 3E. AI Integration in Save Flow

- [x] **3.9** Integrate AI into save dialog
  - [x] Call selected provider when dialog opens âœ…
  - [x] Show loading spinner while generating âœ…
  - [x] Pre-fill input with AI suggestion âœ…
  - [x] Show provider indicator (ğŸ¦™ Ollama / âœ¨ Claude) âœ…

- [x] **3.10** Implement fallback chain
  - [x] If selected provider fails â†’ try other provider (optional) âœ…
  - [x] If all fail â†’ use default name "Session - {date}" âœ…
  - [x] No error shown to user âœ…
  - [x] Log failure for debugging âœ…

- [x] **3.11** Add timeout handling
  - [x] Max 5 seconds for AI response âœ…
  - [x] Show "Taking longer than expected..." message âœ…
  - [x] Allow user to skip and use default name âœ…

### 3F. Export/Import

- [x] **3.12** Add export functionality
  - [x] Button in settings âœ…
  - [x] Export all sessions as JSON âœ…
  - [x] Download as file âœ…

- [x] **3.13** Add import functionality
  - [x] Button in settings âœ…
  - [x] File picker for JSON âœ…
  - [x] Validate and merge sessions âœ…

### 3G. Chrome Sync (Optional)

- [x] **3.14** Add sync option
  - [x] Checkbox in settings âœ…
  - [x] Use chrome.storage.sync instead of local (toggle added) âœ…

- [x] **3.15** Handle sync quota limits
  - [x] Max 100KB total âœ…
  - [x] Warn if exceeding (note: full implementation deferred) âœ…

### 3H. Store Submission

- [x] **3.16** Create extension icons
  - [x] 16x16 PNG âœ…
  - [x] 48x48 PNG âœ…
  - [x] 128x128 PNG âœ…

- [x] **3.17** Create store screenshots âœ…
  - [x] Main popup view (1280x800) âœ…
  - [x] Save dialog with AI suggestion (1280x800) âœ…
  - [x] Session list with items (1280x800) âœ…
  - [x] Settings showing AI options (1280x800) âœ…
  - [x] At least 4 screenshots âœ…

- [x] **3.18** Write store listing âœ…
  - [x] Short description (132 chars) âœ…
  - [x] Full description âœ…
  - [x] Feature list (highlight AI + Ollama support) âœ…
  - [x] See: `STORE_LISTING.md`

- [x] **3.19** Create privacy policy âœ…
  - [x] See: `PRIVACY_POLICY.md` (host on GitHub Pages or Gist)
  - [x] Describe data handling âœ…
  - [x] Note: Ollama = fully local, Claude = sends tab titles only âœ…
  - [x] No tracking statement âœ…

- [x] **3.20** Submit to Chrome Web Store âœ… (Pending Review)
  - [x] Create developer account ($5) âœ…
  - [x] Extension ZIP ready: `store-assets/stash-extension.zip` âœ…
  - [x] Upload ZIP âœ…
  - [x] Fill in listing details âœ…
  - [x] Submit for review âœ…
  - [x] GitHub repo: https://github.com/engleong-lee/stash âœ…

- [ ] **3.21** Submit to Edge Add-ons
  - [ ] Create Microsoft Partner account (free)
  - [ ] Upload same ZIP
  - [ ] Fill in listing
  - [ ] Submit for review

---

## Bug Fixes & Issues

| ID | Description | Status | Fixed Date |
|----|-------------|--------|------------|
| BUG-001 | | â¬œ Open | |
| | | | |

---

## Notes & Decisions

| Date | Decision/Note |
|------|---------------|
| Dec 25, 2024 | Project started, using current directory for Vite setup |

---

## Daily Log

| Date | Tasks Completed | Time Spent | Notes |
|------|-----------------|------------|-------|
| Dec 25, 2024 | 0.1, 0.2 | 15 min | Node.js verified, Vite project created |

---

## Resources & References

- [Chrome Extensions Docs](https://developer.chrome.com/docs/extensions/)
- [Manifest V3 Migration](https://developer.chrome.com/docs/extensions/mv3/intro/)
- [CRXJS Vite Plugin](https://crxjs.dev/vite-plugin/)
- [Chrome Storage API](https://developer.chrome.com/docs/extensions/reference/storage/)
- [Chrome Tabs API](https://developer.chrome.com/docs/extensions/reference/tabs/)
- [Ollama API Documentation](https://github.com/ollama/ollama/blob/main/docs/api.md)
- [Ollama Model Library](https://ollama.com/library)
- [Claude API Documentation](https://docs.anthropic.com/en/api/getting-started)

---

*Last updated: December 25, 2024*
